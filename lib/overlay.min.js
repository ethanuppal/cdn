// Copyright (C) 2022-2023 Ethan Uppal. All rights reserved.
var IO_SEL=function(){return""==(window.getSelection?window:document).getSelection().toString()};class ImageOverlay{constructor(){throw new Error("ImageOverlay cannot be constructed")}static KEY_PREFIX="ethanuppal|overlay.js|";static ID_PREFIX="ethanuppal-overlayjs-";static div;static urlA;static image;static createModal(e){var a,t=(e=e||{}).borderColor||"inherit",r=e.borderWidth||"3px",i=e.imageBorderColor||"inherit",l=e.imageBorderWidth||"1px",o=e.backgroundColor||"inherit",e=(ImageOverlay.persists=e.persists||!1,document.createElement("div"));e.style="display:none;position:fixed;width:100%;height:100%;top:0;left:0;right:0;bottom:0;background-color:rgba(0,0,0,0.8);z-index:10;cursor:pointer",e.addEventListener("click",()=>{IO_SEL()&&ImageOverlay.dismiss()}),e.appendChild(((a=document.createElement("div")).style=`position:fixed;max-width:calc(600px);width:calc(100% - 64px);left:50%;top:50%;transform:translate(calc(-50% - 32px), calc(-50% - 32px));padding:8px;margin:32px;border-color:${t};border-width:${r};border-style:solid;border-radius:15px;background-color:`+o,(t=document.createElement("div")).style="padding:0px 16px;cursor:auto",(r=document.createElement("p")).style="border-style:none",r.innerHTML=`Viewing <b><a id="${ImageOverlay.ID_PREFIX+"url"}"></a></b>. Click anywhere to close.`,t.appendChild(r),(r=document.createElement("div")).style="display:flex;justify-content:center;padding:0 16px 16px;",(o=document.createElement("img")).style=`width:100%;border-color:${i};border-style:solid;border-width:`+l,r.appendChild(o),ImageOverlay.image=o,a.appendChild(t),a.appendChild(r),a)),document.body.appendChild(e),ImageOverlay.div=e,ImageOverlay.urlA=document.getElementById(ImageOverlay.ID_PREFIX+"url")}static attachTriggers(){for(const e of document.getElementsByClassName("overlay-trigger")){const a=Array.from(e.children).find(e=>"IMG"==e.nodeName||e.classList.contains("overlay-image"));a&&(a.style.cursor="pointer",e.addEventListener("click",()=>{IO_SEL()&&ImageOverlay.present({image:a})}))}}static restoreModal(){var e;(e=ImageOverlay.get("image_src"))&&ImageOverlay.present({src:e})}static load(e){ImageOverlay.createModal(e),ImageOverlay.attachTriggers(),ImageOverlay.persists&&ImageOverlay.restoreModal()}static present(e){"src"in e?a=e.src:"image"in e&&(a=e.image.src,t=e.image.alt);var a,t,e=ImageOverlay.image,r=ImageOverlay.urlA;e.src=a,e.alt=t,r.href=a,r.innerText=(e=a).substring(e.lastIndexOf("/")+1),ImageOverlay.div.style.display="block",ImageOverlay.set("image_src",a)}static dismiss(){ImageOverlay.div.style.display="none",ImageOverlay.remove("image_src")}static set(e,a){window.localStorage.setItem(ImageOverlay.KEY_PREFIX+e,a)}static get(e){return window.localStorage.getItem(ImageOverlay.KEY_PREFIX+e)}static remove(e){return window.localStorage.removeItem(ImageOverlay.KEY_PREFIX+e)}}
